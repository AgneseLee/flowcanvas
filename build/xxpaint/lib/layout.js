"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getIsChangeLine = exports.getPreLayout = void 0;
var getPreLayout = function (targetNode) {
    var cur = targetNode.pre;
    if (cur) {
        return {
            width: cur.processedLocation.width,
            height: cur.processedLocation.height,
            x: cur.renderStyle.contentX,
            y: cur.renderStyle.contentY,
        };
    }
    return {
        width: 0,
        height: 0,
        x: _getContainerLayout(targetNode.parent).contentX,
        y: _getContainerLayout(targetNode.parent).contentY,
    };
};
exports.getPreLayout = getPreLayout;
function _getContainerLayout(container) {
    if (!container) {
        if (!container) {
            debugger;
        }
        container = {
            renderStyles: {
                width: container.processedLocation.width,
                height: container.processedLocation.height,
                paddingTop: 0,
                paddingBottom: 0,
                paddingLeft: 0,
                paddingRight: 0,
                marginLeft: 0,
                marginRight: 0,
                marginTop: 0,
                marginBottom: 0,
            },
            x: 0,
            y: 0,
            contentX: 0,
            contentY: 0,
        };
    }
    return {
        width: container.processedLocation.width,
        height: container.processedLocation.height,
        x: container.x,
        y: container.y,
        paddingTop: container.css.paddingTop ? container.css.paddingTop.toPx() : 0,
        paddingBottom: container.css.paddingBottom ? container.css.paddingBottom.toPx() : 0,
        paddingLeft: container.css.paddingLeft ? container.css.paddingLeft.toPx() : 0,
        paddingRight: container.css.paddingRight ? container.css.paddingRight.toPx() : 0,
        marginLeft: container.css.marginLeft ? container.css.marginLeft.toPx() : 0,
        marginRight: container.css.marginRight ? container.css.marginRight.toPx() : 0,
        marginTop: container.css.marginTop ? container.css.marginTop.toPx() : 0,
        marginBottom: container.css.marginBottom ? container.css.marginBottom.toPx() : 0,
        contentX: container.renderStyle.contentX,
        contentY: container.renderStyle.contentY,
    };
}
var getIsChangeLine = function (targetNode) {
    var parent = targetNode.parent;
    var pre = targetNode.pre;
    if (pre) {
        if (pre.type && pre.type === 'block') {
            targetNode.isLines = true;
        }
        else {
            var _a = _getContainerLayout(parent), pw = _a.width, ph = _a.height;
            var _b = exports.getPreLayout(targetNode), x = _b.x, y = _b.y, preW = _b.width, preH = _b.height;
            var childPaddingLeft = targetNode.css.paddingLeft ? targetNode.css.paddingLeft.toPx() : 0;
            var childMarginLeft = targetNode.css.marginLeft ? targetNode.css.marginLeft.toPx() : 0;
            var currW = targetNode.processedLocation.width;
            var nextStartX = x + preW + childPaddingLeft + childMarginLeft + currW;
            targetNode.isLines = nextStartX >= pw;
        }
    }
    else {
        targetNode.isLines = false;
    }
    return targetNode.isLines;
};
exports.getIsChangeLine = getIsChangeLine;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF5b3V0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3h4cGFpbnQvbGliL2xheW91dC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFLTyxJQUFNLFlBQVksR0FBRyxVQUFDLFVBQVU7SUFDckMsSUFBTSxHQUFHLEdBQUcsVUFBVSxDQUFDLEdBQUcsQ0FBQztJQUUzQixJQUFJLEdBQUcsRUFBRTtRQUNQLE9BQU87WUFDTCxLQUFLLEVBQUUsR0FBRyxDQUFDLGlCQUFpQixDQUFDLEtBQUs7WUFDbEMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNO1lBQ3BDLENBQUMsRUFBRSxHQUFHLENBQUMsV0FBVyxDQUFDLFFBQVE7WUFDM0IsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxXQUFXLENBQUMsUUFBUTtTQUM1QixDQUFDO0tBQ0g7SUFDRCxPQUFPO1FBQ0wsS0FBSyxFQUFFLENBQUM7UUFDUixNQUFNLEVBQUUsQ0FBQztRQUNULENBQUMsRUFBRSxtQkFBbUIsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUTtRQUNsRCxDQUFDLEVBQUUsbUJBQW1CLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFFBQVE7S0FDbkQsQ0FBQztBQUNKLENBQUMsQ0FBQztBQWpCVyxRQUFBLFlBQVksZ0JBaUJ2QjtBQU1GLFNBQVMsbUJBQW1CLENBQUMsU0FBUztJQUVwQyxJQUFJLENBQUMsU0FBUyxFQUFFO1FBRWQsSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNkLFFBQVEsQ0FBQztTQUNWO1FBQ0QsU0FBUyxHQUFHO1lBQ1YsWUFBWSxFQUFFO2dCQUNaLEtBQUssRUFBRSxTQUFTLENBQUMsaUJBQWlCLENBQUMsS0FBSztnQkFDeEMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNO2dCQUMxQyxVQUFVLEVBQUUsQ0FBQztnQkFDYixhQUFhLEVBQUUsQ0FBQztnQkFDaEIsV0FBVyxFQUFFLENB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QUFJLFlBQTZCLENBQUM7WUFDckUsSUFBTSxnQkFBZ0IsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM1RixJQUFNLGVBQWUsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN6RixJQUFNLEtBQUssR0FBRyxVQUFVLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDO1lBQ2pELElBQU0sVUFBVSxHQUFHLENBQUMsR0FBRyxJQUFJLEdBQUcsZ0JBQWdCLEdBQUcsZUFBZSxHQUFHLEtBQUssQ0FBQztZQUV6RSxVQUFVLENBQUMsT0FBTyxHQUFHLFVBQVUsSUFBSSxFQUFFLENBQUM7U0FDdkM7S0FFRjtTQUFNO1FBRUwsVUFBVSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7S0FDNUI7SUFDRCxPQUFPLFVBQVUsQ0FBQyxPQUFPLENBQUM7QUFDNUIsQ0FBQyxDQUFDO0FBekJXLFFBQUEsZUFBZSxtQkF5QjFCIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgKi9cbi8qKlxuICog6I635Y+W5YmN5LiA5Liq5YWE5byf6IqC54K577yI5peg5YmN5LiA5Liq5YWE5byf6IqC54K55YiZ6K+75Y+W54i26IqC54K555qE77yJ55qE5a696auY5L2N572uXG4gKiBAcGFyYW0ge29iamVjdH0gdGFyZ2V0Tm9kZVxuICovXG5leHBvcnQgY29uc3QgZ2V0UHJlTGF5b3V0ID0gKHRhcmdldE5vZGUpID0+IHtcbiAgY29uc3QgY3VyID0gdGFyZ2V0Tm9kZS5wcmU7XG4gIC8vIOWmguaenOayoeacieWJjeS4gOS4quaIluiAheWJjemdoueahOmDveS4jeWcqOaWh+aho+a1geS4re+8jOiOt+WPluWuueWZqOeahFxuICBpZiAoY3VyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiBjdXIucHJvY2Vzc2VkTG9jYXRpb24ud2lkdGgsXG4gICAgICBoZWlnaHQ6IGN1ci5wcm9jZXNzZWRMb2NhdGlvbi5oZWlnaHQsXG4gICAgICB4OiBjdXIucmVuZGVyU3R5bGUuY29udGVudFgsXG4gICAgICB5OiBjdXIucmVuZGVyU3R5bGUuY29udGVudFksXG4gICAgfTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHdpZHRoOiAwLFxuICAgIGhlaWdodDogMCxcbiAgICB4OiBfZ2V0Q29udGFpbmVyTGF5b3V0KHRhcmdldE5vZGUucGFyZW50KS5jb250ZW50WCxcbiAgICB5OiBfZ2V0Q29udGFpbmVyTGF5b3V0KHRhcmdldE5vZGUucGFyZW50KS5jb250ZW50WSxcbiAgfTtcbn07XG5cbi8qKlxuICog6I635Y+W54i26IqC54K55a696auY5L2N572ucGFkZGluZy9tYXJnaW7lsZ7mgKdcbiAqIEBwYXJhbSB7b2JqZWN0fSBjb250YWluZXIg54i26IqC54K5XG4gKi9cbmZ1bmN0aW9uIF9nZXRDb250YWluZXJMYXlvdXQoY29udGFpbmVyKSB7XG4gIC8vIGRlYnVnZ2VyXG4gIGlmICghY29udGFpbmVyKSB7XG4gICAgLy8gcm9vdFxuICAgIGlmICghY29udGFpbmVyKSB7XG4gICAgICBkZWJ1Z2dlcjtcbiAgICB9XG4gICAgY29udGFpbmVyID0ge1xuICAgICAgcmVuZGVyU3R5bGVzOiB7XG4gICAgICAgIHdpZHRoOiBjb250YWluZXIucHJvY2Vzc2VkTG9jYXRpb24ud2lkdGgsXG4gICAgICAgIGhlaWdodDogY29udGFpbmVyLnByb2Nlc3NlZExvY2F0aW9uLmhlaWdodCxcbiAgICAgICAgcGFkZGluZ1RvcDogMCxcbiAgICAgICAgcGFkZGluZ0JvdHRvbTogMCxcbiAgICAgICAgcGFkZGluZ0xlZnQ6IDAsXG4gICAgICAgIHBhZGRpbmdSaWdodDogMCxcbiAgICAgICAgbWFyZ2luTGVmdDogMCxcbiAgICAgICAgbWFyZ2luUmlnaHQ6IDAsXG4gICAgICAgIG1hcmdpblRvcDogMCxcbiAgICAgICAgbWFyZ2luQm90dG9tOiAwLFxuICAgICAgICAvLyBjb250ZW50V2lkdGg6IGNvbnRhaW5lci5wcm9jZXNzZWRMb2NhdGlvbi53aWR0aCxcbiAgICAgICAgLy8gY29udGVudEhlaWdodDogY29udGFpbmVyLnByb2Nlc3NlZExvY2F0aW9uLmhlaWdodFxuICAgICAgfSxcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwLFxuICAgICAgY29udGVudFg6IDAsXG4gICAgICBjb250ZW50WTogMCxcbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgd2lkdGg6IGNvbnRhaW5lci5wcm9jZXNzZWRMb2NhdGlvbi53aWR0aCxcbiAgICBoZWlnaHQ6IGNvbnRhaW5lci5wcm9jZXNzZWRMb2NhdGlvbi5oZWlnaHQsXG4gICAgeDogY29udGFpbmVyLngsXG4gICAgeTogY29udGFpbmVyLnksXG4gICAgcGFkZGluZ1RvcDogY29udGFpbmVyLmNzcy5wYWRkaW5nVG9wID8gY29udGFpbmVyLmNzcy5wYWRkaW5nVG9wLnRvUHgoKSA6IDAsXG4gICAgcGFkZGluZ0JvdHRvbTogY29udGFpbmVyLmNzcy5wYWRkaW5nQm90dG9tID8gY29udGFpbmVyLmNzcy5wYWRkaW5nQm90dG9tLnRvUHgoKSA6IDAsXG4gICAgcGFkZGluZ0xlZnQ6IGNvbnRhaW5lci5jc3MucGFkZGluZ0xlZnQgPyBjb250YWluZXIuY3NzLnBhZGRpbmdMZWZ0LnRvUHgoKSA6IDAsXG4gICAgcGFkZGluZ1JpZ2h0OiBjb250YWluZXIuY3NzLnBhZGRpbmdSaWdodCA/IGNvbnRhaW5lci5jc3MucGFkZGluZ1JpZ2h0LnRvUHgoKSA6IDAsXG4gICAgbWFyZ2luTGVmdDogY29udGFpbmVyLmNzcy5tYXJnaW5MZWZ0ID8gY29udGFpbmVyLmNzcy5tYXJnaW5MZWZ0LnRvUHgoKSA6IDAsXG4gICAgbWFyZ2luUmlnaHQ6IGNvbnRhaW5lci5jc3MubWFyZ2luUmlnaHQgPyBjb250YWluZXIuY3NzLm1hcmdpblJpZ2h0LnRvUHgoKSA6IDAsXG4gICAgbWFyZ2luVG9wOiBjb250YWluZXIuY3NzLm1hcmdpblRvcCA/IGNvbnRhaW5lci5jc3MubWFyZ2luVG9wLnRvUHgoKSA6IDAsXG4gICAgbWFyZ2luQm90dG9tOiBjb250YWluZXIuY3NzLm1hcmdpbkJvdHRvbSA/IGNvbnRhaW5lci5jc3MubWFyZ2luQm90dG9tLnRvUHgoKSA6IDAsXG4gICAgY29udGVudFg6IGNvbnRhaW5lci5yZW5kZXJTdHlsZS5jb250ZW50WCxcbiAgICBjb250ZW50WTogY29udGFpbmVyLnJlbmRlclN0eWxlLmNvbnRlbnRZLFxuICAgIC8vIGNvbnRlbnRXaWR0aDogY29udGFpbmVyLnJlbmRlclN0eWxlcy5jb250ZW50V2lkdGgsXG4gICAgLy8gY29udGVudEhlaWdodDogY29udGFpbmVyLnJlbmRlclN0eWxlcy5jb250ZW50SGVpZ2h0XG4gIH07XG59XG5cbi8qKlxuICog6IqC54K55piv5ZCm5o2i6KGMXG4gKiBAcGFyYW0ge29iamVjdH0gdGFyZ2V0Tm9kZVxuICovXG5leHBvcnQgY29uc3QgZ2V0SXNDaGFuZ2VMaW5lID0gKHRhcmdldE5vZGUpID0+IHtcbiAgLy8gZGVidWdnZXJcbiAgY29uc3QgcGFyZW50ID0gdGFyZ2V0Tm9kZS5wYXJlbnQ7XG4gIGNvbnN0IHByZSA9IHRhcmdldE5vZGUucHJlO1xuICBpZiAocHJlKSB7XG4gICAgLy8g6Z2e56ys5LiA5Liq5a2Q6IqC54K5XG4gICAgaWYgKHByZS50eXBlICYmIHByZS50eXBlID09PSAnYmxvY2snKSB7XG4gICAgICAvLyDliY3kuIDkuKrlhYTlvJ/oioLngrnmmK9ibG9ja++8jOW9k+WJjeiKgueCueW/hemhu+aNouihjFxuICAgICAgdGFyZ2V0Tm9kZS5pc0xpbmVzID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgeyB3aWR0aDogcHcsIGhlaWdodDogcGggfSA9IF9nZXRDb250YWluZXJMYXlvdXQocGFyZW50KTtcbiAgICAgIGNvbnN0IHsgeCwgeSwgd2lkdGg6IHByZVcsIGhlaWdodDogcHJlSCB9ID0gZ2V0UHJlTGF5b3V0KHRhcmdldE5vZGUpO1xuICAgICAgY29uc3QgY2hpbGRQYWRkaW5nTGVmdCA9IHRhcmdldE5vZGUuY3NzLnBhZGRpbmdMZWZ0ID8gdGFyZ2V0Tm9kZS5jc3MucGFkZGluZ0xlZnQudG9QeCgpIDogMDtcbiAgICAgIGNvbnN0IGNoaWxkTWFyZ2luTGVmdCA9IHRhcmdldE5vZGUuY3NzLm1hcmdpbkxlZnQgPyB0YXJnZXROb2RlLmNzcy5tYXJnaW5MZWZ0LnRvUHgoKSA6IDA7XG4gICAgICBjb25zdCBjdXJyVyA9IHRhcmdldE5vZGUucHJvY2Vzc2VkTG9jYXRpb24ud2lkdGg7XG4gICAgICBjb25zdCBuZXh0U3RhcnRYID0geCArIHByZVcgKyBjaGlsZFBhZGRpbmdMZWZ0ICsgY2hpbGRNYXJnaW5MZWZ0ICsgY3Vyclc7XG5cbiAgICAgIHRhcmdldE5vZGUuaXNMaW5lcyA9IG5leHRTdGFydFggPj0gcHc7XG4gICAgfVxuICAgIC8vIGRlYnVnZ2VyXG4gIH0gZWxzZSB7XG4gICAgLy8g56ys5LiA5Liq5a2Q6IqC54K55LiN6ZyA5Yik5pat5piv5ZCm5o2i6KGMXG4gICAgdGFyZ2V0Tm9kZS5pc0xpbmVzID0gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRhcmdldE5vZGUuaXNMaW5lcztcbn07XG4iXX0=